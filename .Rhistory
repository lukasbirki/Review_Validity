distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(labels = c("T999", "T888","T888"))+
theme_Publication() -> barchart_source
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(title = "xx",labels = c("Social Media Data", "Party Politics","Others"))+
theme_Publication() -> barchart_source
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(title = "xx",labels = c("Social Media Data", "Party Politics","Others"))+
theme_Publication() -> barchart_source
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(name = "Data Type",labels = c("Social Media Data", "Party Politics","Others"))+
theme_Publication() -> barchart_source
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(name = "Data Type",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() -> barchart_source
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column()
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(c("Party Politics:")))
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics:")))
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics:")))
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: ")))
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: "))) %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(name = "Data Type",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() -> barchart_source
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: ")))
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c(" Party Politics: ","Social Media: "))) %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(name = "Data Type",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() -> barchart_source
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: "))) %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(name = "Data Type",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() -> barchart_source
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: "))) -> y
y$source
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: ")))  %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(name = "Data Type",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() -> barchart_source
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: ")))  %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(title = "Data Sources", x = "Data", y = "n") +
scale_fill_Publication(name = "Source",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() -> barchart_source
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
## Data Source
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) -> df_source_multiple
df_source_multiple
## Method Type
df_plot %>%
distinct(id, method_type) %>%
mutate(method_short = case_when(
startsWith(as.character(method_type),"Super") ~ "Supervised",
startsWith(as.character(method_type),"Unsuper") ~ "Unsupervised",
startsWith(as.character(method_type),"Rule") ~ "Dictionary",
T ~ "Others")) %>%
ggplot(aes(x=reorder(method_short, table(method_short)[method_short]),fill = factor(method_short))) +
geom_bar() +
coord_flip() +
labs(x = "Type", y = "n", fill = "Method") +
theme_Publication()+  scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_method
barchart_method
## Method Type
df_plot %>%
distinct(id, method_type) %>%
mutate(method_short = case_when(
startsWith(as.character(method_type),"Super") ~ "Supervised",
startsWith(as.character(method_type),"Unsuper") ~ "Unsupervised",
startsWith(as.character(method_type),"Rule") ~ "Dictionary",
T ~ "Others")) %>%
ggplot(aes(x=reorder(method_short, table(method_short)[method_short]),fill = factor(method_short))) +
geom_bar() +
labs(x = "Type", y = "n", fill = "Method") +
theme_Publication()+  scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_method
barchart_method
### df_plot %>%
df_plot %>% mutate(language_combined = case_when(
language == "English"~ language,
T ~ language_others)) %>%
distinct(id, language_combined) %>%
separate_rows(language_combined,sep = ",") %>% mutate(language_combined = trimws(language_combined)) -> df_temp
df_temp%>%
count(language_combined) %>% left_join(df_temp, ., by = "language_combined") %>%
mutate(language_combined = case_when(
(n > 1) ~ language_combined,
(n == 1) ~ "Others")) %>%
ggplot(aes(x=reorder(language_combined, table(language_combined)[language_combined]),fill = factor(language_combined))) +
geom_bar() +
coord_flip() +
labs(x = "Language", y = "n", fill = "Language") +
theme_Publication()+
scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_language
barchart_language
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method),labels = c("Language","Method Type"),nrow = 1) -> souce_overview
souce_overview
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method),labels = c("Language","Method Type"),nrow = 2) -> souce_overview
warnings()
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method),labels = c("Language","Method Type"),nrow = 2) -> souce_overview
ggsave(plot =barchart_source ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 13, height = 6)
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 6, height = 10)
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method),labels = c("Source","Langauge | Method Type"),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
ggpubr::ggarrange(barchart_language,barchart_method,labels = c("XX","YYY"),labels = c("Source",""),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method,labels = c("XX","YYY")),labels = c("Source",""),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method,labels = c("DataLanguage","Method Type")),labels = c("Data Source",""),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
### Source
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: ")))  %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(x = "Data", y = "n") +
scale_fill_Publication(name = "Source",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() -> barchart_source
## Type
df_plot %>%
distinct(id, method_type) %>%
mutate(method_short = case_when(
startsWith(as.character(method_type),"Super") ~ "Supervised",
startsWith(as.character(method_type),"Unsuper") ~ "Unsupervised",
startsWith(as.character(method_type),"Rule") ~ "Dictionary",
T ~ "Others")) %>%
ggplot(aes(x=reorder(method_short, table(method_short)[method_short]),fill = factor(method_short))) +
geom_bar() +
labs(x = "Type", y = "n", fill = "Method") +
theme_Publication()+  scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_method
### df_plot %>%
df_plot %>% mutate(language_combined = case_when(
language == "English"~ language,
T ~ language_others)) %>%
distinct(id, language_combined) %>%
separate_rows(language_combined,sep = ",") %>% mutate(language_combined = trimws(language_combined)) -> df_temp
df_temp%>%
count(language_combined) %>% left_join(df_temp, ., by = "language_combined") %>%
mutate(language_combined = case_when(
(n > 1) ~ language_combined,
(n == 1) ~ "Others")) %>%
ggplot(aes(x=reorder(language_combined, table(language_combined)[language_combined]),fill = factor(language_combined))) +
geom_bar() +
coord_flip() +
labs(x = "Language", y = "n", fill = "Language") +
theme_Publication()+
scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_language
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method,labels = c("DataLanguage","Method Type")),labels = c("Data Source",""),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
### Source
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: ")))  %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "n") +
scale_fill_Publication(name = "Source",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() -> barchart_source
## Type
df_plot %>%
distinct(id, method_type) %>%
mutate(method_short = case_when(
startsWith(as.character(method_type),"Super") ~ "Supervised",
startsWith(as.character(method_type),"Unsuper") ~ "Unsupervised",
startsWith(as.character(method_type),"Rule") ~ "Dictionary",
T ~ "Others")) %>%
ggplot(aes(x=reorder(method_short, table(method_short)[method_short]),fill = factor(method_short))) +
geom_bar() +
labs(x = "Type", y = "n", fill = "Method") +
theme_Publication()+  scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_method
### df_plot %>%
df_plot %>% mutate(language_combined = case_when(
language == "English"~ language,
T ~ language_others)) %>%
distinct(id, language_combined) %>%
separate_rows(language_combined,sep = ",") %>% mutate(language_combined = trimws(language_combined)) -> df_temp
df_temp%>%
count(language_combined) %>% left_join(df_temp, ., by = "language_combined") %>%
mutate(language_combined = case_when(
(n > 1) ~ language_combined,
(n == 1) ~ "Others")) %>%
ggplot(aes(x=reorder(language_combined, table(language_combined)[language_combined]),fill = factor(language_combined))) +
geom_bar() +
coord_flip() +
labs(x = "Language", y = "n", fill = "Language") +
theme_Publication()+
scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_language
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method,labels = c("DataLanguage","Method Type")),labels = c("Data Source",""),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
### Source
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: ")))  %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "n") +
scale_fill_Publication(name = "Source",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() +theme(axis.title.y = element_blank())-> barchart_source
barchart_source
### Source
df_plot %>%
distinct(id, source) %>%
separate_rows(source,sep = ",") %>% mutate(source = trimws(source)) %>%
mutate(group = case_when(
startsWith(as.character(source),"Party") ~ "Party Politics",
startsWith(as.character(source),"Social") ~ "Social Media",
T ~ "Others")) %>%
count(group, source, sort = T) %>% arrange(group,-n) %>% rowid_to_column() %>%
mutate(source = str_remove_all(source, c("Party Politics: ","Social Media: ")))  %>%
ggplot(aes(x=reorder(source,-rowid), y = n, fill = group)) +
geom_bar(stat = "identity") +
coord_flip() +
labs(y = "n") +
scale_fill_Publication(name = "Source",labels = c("Social Media", "Party Politics","Others"))+
theme_Publication() +theme(axis.title.y = element_blank())-> barchart_source
## Type
df_plot %>%
distinct(id, method_type) %>%
mutate(method_short = case_when(
startsWith(as.character(method_type),"Super") ~ "Supervised",
startsWith(as.character(method_type),"Unsuper") ~ "Unsupervised",
startsWith(as.character(method_type),"Rule") ~ "Dictionary",
T ~ "Others")) %>%
ggplot(aes(x=reorder(method_short, table(method_short)[method_short]),fill = factor(method_short))) +
geom_bar() +
labs(x = "Type", y = "n", fill = "Method") +
theme_Publication()+  scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_method
### df_plot %>%
df_plot %>% mutate(language_combined = case_when(
language == "English"~ language,
T ~ language_others)) %>%
distinct(id, language_combined) %>%
separate_rows(language_combined,sep = ",") %>% mutate(language_combined = trimws(language_combined)) -> df_temp
df_temp%>%
count(language_combined) %>% left_join(df_temp, ., by = "language_combined") %>%
mutate(language_combined = case_when(
(n > 1) ~ language_combined,
(n == 1) ~ "Others")) %>%
ggplot(aes(x=reorder(language_combined, table(language_combined)[language_combined]),fill = factor(language_combined))) +
geom_bar() +
coord_flip() +
labs(x = "Language", y = "n", fill = "Language") +
theme_Publication()+
scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_language
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method,labels = c("DataLanguage","Method Type")),labels = c("Data Source",""),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
df_temp%>%
count(language_combined) %>% left_join(df_temp, ., by = "language_combined") %>%
mutate(language_combined = case_when(
(n > 1) ~ language_combined,
(n == 1) ~ "Others")) %>%
ggplot(aes(x=reorder(language_combined, table(language_combined)[language_combined]),fill = factor(language_combined))) +
geom_bar() +
coord_flip() +
labs(x = "Language", y = "n", fill = "Language") +
theme_Publication()+
scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_language
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method,labels = c("Data Language","Method Type")),labels = c("Data Source",""),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
## Type
df_plot %>%
distinct(id, method_type) %>%
mutate(method_short = case_when(
startsWith(as.character(method_type),"Super") ~ "Supervised",
startsWith(as.character(method_type),"Unsuper") ~ "Unsupervised",
startsWith(as.character(method_type),"Rule") ~ "Dictionary",
T ~ "Others")) %>%
ggplot(aes(x=reorder(method_short, table(method_short)[method_short]),fill = factor(method_short))) +
geom_bar() +
labs(x = "Type", y = "n", fill = "Method") +
theme_Publication()+  scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none",axis.title.x = element_blank()) -> barchart_method
### df_plot %>%
df_plot %>% mutate(language_combined = case_when(
language == "English"~ language,
T ~ language_others)) %>%
distinct(id, language_combined) %>%
separate_rows(language_combined,sep = ",") %>% mutate(language_combined = trimws(language_combined)) -> df_temp
df_temp%>%
count(language_combined) %>% left_join(df_temp, ., by = "language_combined") %>%
mutate(language_combined = case_when(
(n > 1) ~ language_combined,
(n == 1) ~ "Others")) %>%
ggplot(aes(x=reorder(language_combined, table(language_combined)[language_combined]),fill = factor(language_combined))) +
geom_bar() +
coord_flip() +
labs(x = "Language", y = "n", fill = "Language") +
theme_Publication()+
scale_fill_Publication()+
theme(axis.title.y = element_blank(),legend.position = "none") -> barchart_language
ggpubr::ggarrange(barchart_source,
ggpubr::ggarrange(barchart_language,barchart_method,labels = c("Data Language","Method Type")),labels = c("Data Source",""),nrow = 2) -> souce_overview
ggsave(plot =souce_overview ,filename = "Review/3_plots/output/barchart_source.png",width = 10, height = 10)
